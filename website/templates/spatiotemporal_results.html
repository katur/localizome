{% extends "base_matrix.html"%}


{% block page_title %}
	<h3>
		Co-expressed Proteins
		{% if compartment and timepoint %}
			in <span class="header-emphasis">{{ compartment.name }}</span> 
			at <span class="header-emphasis">{{ timepoint.get_cell_cycle_category_display }}: </span>
			<span class="header-emphasis">{{ timepoint.name }}</span>
		{% elif compartment %}
			in <span class="header-emphasis">{{ compartment.name }}</span>
		{% elif timepoint %}
			at <span class="header-emphasis">{{ timepoint.get_cell_cycle_category_display }}: {{ timepoint.name }}</span>
		{% endif %}
	</h3>
{% endblock %}


{% block prematrix %}
	<div id="below-header">
		{% if signals %}
			Showing all proteins present or weak
			{% if compartment and timepoint %}
				in this compartment and timepoint.
			{% elif compartment %}
				in this compartment.
			{% elif timepoint %}
				at this timepoint.
			{% endif %}
			
		{% else %}
			No proteins expressed
			{% if compartment and timepoint %}
				in this compartment and timepoint.
			{% elif compartment %}
				in this compartment.
			{% elif timepoint %}
				at this timepoint.
			{% endif %}

		{% endif %}
	</div>
{% endblock prematrix %}


{% block next_to_matrix %}
	{% if signals %}
		<div id="next-to-matrix" class="shaded-box">
			{% include "matrix_key_normal.html" %}
		</div>
	{% endif %}		
{% endblock next_to_matrix %}


{% block matrix %}
	{% if signals %}
		<table class="matrix">
			{% if compartment %}
				{% include "matrix_xaxis_timepoints.html" %}
			{% elif timepoint %}
				{% include "matrix_xaxis_compartments.html" %}
			{% endif %}

			{% regroup signals by protein_id as proteins_signals %}
			
			{% for protein_signals in proteins_signals %}
				<tr>
					{% with protein_signals.list.0.protein as protein %}
						<th class="left-column y-axis-spatiotemporal-result row-header" colspan="2">
							<a href="{% url website.views.protein_detail common_name=protein %}">
								{{ protein|upper }}
							</a>
						</th>
						<th class="y-axis-spatiotemporal-result row-header">
							{{ protein.sequence }}
						</th>
					{% endwith %}
					
					{% for signal in protein_signals.list %}
						<td class="signal
							strength{{ signal.strength }}
							{% if compartment %}
								{% if forloop.counter == 8 or forloop.counter == 14 %}
									bold-right
								{% endif %}
							{% elif timepoint %}
								{% if forloop.counter == 4 or forloop.counter == 15 %}
									bold-right
								{% endif %}
							{% endif %}
						"></td>
					{% endfor %}
				</tr>
			{% endfor %}
		</table>
	{% endif %}
{% endblock matrix %}
